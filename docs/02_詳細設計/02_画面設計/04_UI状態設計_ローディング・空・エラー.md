# 詳細設計：UI 状態設計（ローディング・空・エラー）

## 1. 本書の目的

本書は、全画面に共通する UI 状態（ローディング、空状態、エラー状態）の表示ルールを定義し、画面体験を統一する。

## 2. ローディング（Loading）

- 一覧：スケルトン（行/カードの形を維持）
- 詳細：主要領域のスケルトン（タイトル/本文/ボタン）
- 生成（/plans/generate）：ボタンを disabled にし、画面内に進行表示を出す

## 3. 空状態（Empty State）

### 3.1 空状態の定義

- data が空配列、または該当データが存在しない状態

### 3.2 画面別の空状態

- タスク一覧：タスクが存在しない
  - メッセージ：タスクがまだありません
  - 導線：タスク作成（Primary）
- 固定予定一覧：対象日に固定予定が存在しない
  - メッセージ：この日の固定予定はありません
  - 導線：固定予定作成（Primary）
- 計画一覧：計画が存在しない
  - メッセージ：計画がまだありません
  - 導線：計画を生成（Primary）

## 4. エラー状態（Error）

### 4.1 エラーの分類

- 入力エラー：400（field_errors あり）
- 対象なし：404
- サーバ障害：500

### 4.2 表示ルール

- 400：該当項目直下に field_errors を表示し、画面上部に代表エラーを表示する
- 404：画面上部に表示し、一覧へ戻る導線を提供する
- 500：画面上部に表示し、「再試行」導線を提供する

### 4.3 message_id と表示

- API の error.message_id を必ずログ出力（フロント側）
- UI 表示は message_id に対応する文言がある場合はそれを優先する
- UI 側定義がない場合は API の error.message を表示する

## 5. 計画生成における特記事項

- overflow / warnings / LLM 失敗は「エラー」ではなく「注意」として画面内に表示する
- 生成自体が失敗（400/500）の場合のみエラー状態を出す
