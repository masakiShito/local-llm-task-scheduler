# 詳細設計：バリデーション 概要（MVP）

## 1. 本書の目的

本書は、API および画面で行うバリデーションの方針・責務分担・表現方法を定義し、
実装およびテストの基準を統一することを目的とする。

## 2. バリデーションの責務分担

### 2.1 クライアント（UI）

- 入力補助・即時フィードバックを目的とする
- 必須チェック・形式チェック・簡易整合性チェックを行う
- UI バリデーションをすり抜けた入力が存在する前提で設計する

### 2.2 サーバ（API）

- **最終的な正**とする
- 形式・範囲・整合性をすべて検証する
- 不正な入力は必ず 400 + field_errors で返却する

---

## 3. バリデーションエラーの表現

### 3.1 共通ルール

- ステータスコード：400 Bad Request
- error.message_id：E-0400
- error.field_errors：配列（0 件以上）

### 3.2 field_errors の仕様

- field：リクエスト JSON のキー名
- ネストはドット表記とする

例：

- title
- working_hours.0.start
- constraints.buffer_ratio

---

## 4. バリデーションの種類

| 種類           | 説明                 |
| -------------- | -------------------- |
| 必須チェック   | 未入力・null 不可    |
| 形式チェック   | 型・フォーマット     |
| 範囲チェック   | 数値・文字数の上下限 |
| 整合性チェック | 項目間の関係性       |
| ドメインルール | 業務ルール違反       |

---

## 5. 禁止事項

- バリデーションエラーを 200 で返却しない
- message_id を持たないエラーを返却しない
- field_errors.field に存在しないキー名を使用しない
