【ファイル名】docs/99\_プロンプト/README.md

# CodeX 実行用プロンプト集（Task Scheduler App）

## 1. 本フォルダの目的

本フォルダは、CodeX（および類似の AI コーディング支援）が  
**実装時に必ず参照すべき前提・制約・設計思想** をまとめたものである。

このプロジェクトでは以下を最重要視する。

- 設計書に基づいた実装
- 再現性・決定論の担保
- AI の暴走防止

---

## 2. CodeX 利用時の絶対ルール（最重要）

### 2.1 設計書優先順位

実装時は必ず以下の順で判断すること。

1. 詳細設計（docs/詳細設計）
2. 基本設計（docs/基本設計）
3. 要件定義（docs/要件定義）
4. README.md

**設計書に書かれていない挙動は実装しない。**

---

### 2.2 禁止事項

- AI 独自判断で仕様を追加しない
- スケジューリングを LLM に任せない
- message_id を持たないエラーを作らない
- レスポンス形式を勝手に変えない
- トランザクション境界を曖昧にしない

---

## 3. 本プロジェクトの思想（必読）

### 3.1 スケジューリングの責務分離

- スケジューリング結果を決めるのは **ロジック**
- LLM は結果を「説明するだけ」

LLM の出力が blocks / overflow / warnings に影響を与えてはならない。

---

### 3.2 決定論（Deterministic）

- 同一入力 → 同一出力
- 乱数・現在時刻依存は禁止
- 並び順は必ず明示的にソートする

---

## 4. 実装時に必ず参照する設計書

### 4.1 API 実装時

- docs/詳細設計/01_API 共通仕様.md
- docs/詳細設計/03_API 設計/
- docs/詳細設計/05\_バリデーション/
- docs/詳細設計/06\_エラー仕様/

### 4.2 スケジューラ実装時

- docs/詳細設計/04\_スケジューリング/
  - 01\_スケジューラ I-O 仕様.md
  - 02\_割当ルール・優先順位.md
  - 03_overflow・warnings 仕様.md

### 4.3 DB / 永続化実装時

- docs/詳細設計/07\_永続化・トランザクション/
  - 01\_トランザクション設計.md
  - 02\_永続化設計.md
  - 03\_テーブル制約設計.md

---

## 5. CodeX 用 基本プロンプト（共通）

以下を **常に system / instruction に含めること**。

---

あなたは Task Scheduler App の実装を担当するエンジニアです。  
以下の制約を必ず守ってください。

- 設計書に記載のある仕様のみを実装する
- 仕様に曖昧な点がある場合は実装せずコメントで指摘する
- スケジューリングはロジックで実装する
- LLM は説明生成以外に使用しない
- 出力形式（API レスポンス、message_id）は設計書に完全準拠する
- 勝手な最適化・拡張は行わない

---

## 6. CodeX 用 プロンプト例（用途別）

### 6.1 API 実装用

- 対象設計書：
  - 03_API 設計/xx_API.md
  - 05\_バリデーション/
  - 06\_エラー仕様/

依頼文例：

「以下の API 設計書に基づいて FastAPI で実装してください。
設計書に書かれていない挙動は実装しないでください。」

---

### 6.2 スケジューラ実装用

- 対象設計書：
  - 04\_スケジューリング 配下すべて

依頼文例：

「割当ルール・優先順位に完全準拠した
決定論的スケジューラを実装してください。」

---

### 6.3 テスト実装用

- 対象設計書：
  - 08*テスト設計/01*テスト観点一覧.md

依頼文例：

「P0 観点のみを満たす pytest のテストを作成してください。
期待値は決定論的に比較してください。」

---

## 7. 仕様変更時のルール

- 設計書を先に修正する
- 設計書 → README → 実装 の順で反映
- 設計書なしの修正は禁止

---

## 8. このフォルダの位置づけ

- 本フォルダは「AI 向け仕様書」である
- 人間向け設計書の要約ではない
- CodeX が“勝手に考えなくて済む状態”を作るためのもの

---

## 9. 最後に

このプロジェクトの価値は  
**「AI を使っていること」ではなく  
「AI を制御できていること」** にある。

CodeX は設計に従って実装するための道具であり、
設計を上書きする存在ではない。
